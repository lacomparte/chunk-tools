---
allowed-tools: Bash(git status:*), Bash(git branch:*), Bash(git log:*), Bash(git diff:*), Bash(git push:*), Bash(gh:*), Bash(which:*)
description: Git 상태 자동 분석 → 브랜치 push → JIRA 티켓 연동 → 한글 PR 생성 (draft 기본)
---

<!--
🔄 이 파일은 fe-shared-project에서 자동 동기화됩니다
관리 위치: https://github.com/musinsa/fe-shared-project
⚠️ 이 파일을 직접 수정하지 마세요. 다음 동기화 시 덮어씌워집니다.
-->

# Claude Command: PR Create

이 명령어는 GitHub에서 Pull Request를 생성하는 데 도움을 줍니다. 한국어로 PR 내용을 작성하며, 기본적으로 draft 상태로 생성됩니다.

## 자동 실행 명령어

다음 명령어들이 자동으로 실행되어 컨텍스트에 포함됩니다:

- 현재 브랜치: !`git branch --show-current`
- Git 상태: !`git status`
- 최근 커밋 로그 (10개): !`git log -10 --oneline`

## 사용법

기본 사용법 (draft PR 생성):

```bash
/pr-create
```

옵션과 함께:

```bash
/pr-create --open    # 일반 PR로 생성 (draft 아님)
/pr-create --draft   # 명시적으로 draft PR로 생성
```

## 명령어 옵션

- `--open`: 일반 PR로 생성 (draft 상태가 아님)
- `--draft`: 명시적으로 draft PR로 생성 (기본값)

## GitHub 통신

- GitHub CLI (`gh pr`) 우선 사용 (rate limit 안정적, `gh pr create --assignee @me`)
- 실패 시 GitHub MCP 사용

## PR 생성 과정

### 1단계: 브랜치 확인 및 Push

- 자동 실행된 현재 브랜치 정보 확인
- 현재 브랜치를 원격 저장소에 push (`git push origin <branch>`)
- **Push 실패 시 에러 메시지 출력 후 중단**
- 자동 실행된 커밋 로그로 base 브랜치와의 차이점 분석
- 자동 수집된 commit 히스토리 검토

### 2단계: PR 템플릿 확인

- `.github/pull_request_template.md` 확인
- 템플릿 형식에 따라 PR 작성

### 3단계: JIRA 티켓 정보 수집 (선택적)

- 브랜치 이름에서 JIRA 이슈 번호 추출
- **가능한 경우** atlassian MCP를 사용하여 티켓 상세 정보 조회 시도
- **MCP 실패 시에도 PR 생성 계속 진행** (티켓 번호만 제목에 포함)
- 티켓 조회 성공 시: 비즈니스 배경, 요구사항을 PR 본문에 포함
- 티켓 조회 실패 시: 코드 변경사항 분석만으로 PR 작성

### 4단계: PR 내용 및 AI 기여도 요약 생성

- **한국어로 제목과 본문 작성**
- **제목 형식**: `타입: 티켓번호 변경사항 요약` (예: `feat: AUTH-123 다중 인증 시스템 추가`)
  - 브랜치에서 JIRA 티켓 번호를 추출한 경우 **반드시** 타입 뒤에 `티켓번호` 포함 (대괄호 없이)
  - 티켓 번호가 없는 경우에만 생략 (예: `feat: 다중 인증 시스템 추가`)
- JIRA 티켓 조회 성공 시: 비즈니스 배경을 PR 본문에 포함하고 변경사항 연결
- JIRA 티켓 조회 실패 시: 코드 변경사항만으로 본문 작성
- 변경 사항을 요약하여 설명
- 테스트 계획 및 체크리스트 포함
- JIRA 링크 자동 추가
- **커밋 메시지를 분석하여 AI 기여도 요약 생성** (평균 기여도만 간단히 표시)

### 5단계: 사용자 검증 및 승인

- 생성된 PR 내용을 사용자에게 표시
- AI 기여도 분석 요약 미리보기 표시 (평균 기여도만)
- 사용자 승인 및 선택적 기여도 비율 입력 받기:
    - `y`, `ㅇ`, `ㄱ` 등 긍정 응답: PR 생성 (AI 분석 기여도 그대로 사용)
    - `"50:50"`, `"3:7"` 등 수치:수치 형식: PR 생성 + 사용자 체감 비율 기록
    - `"내가다해먹음"`, `"반반"`, `"AI가 거의 다했다"` 등 서술형: PR 생성 + 서술형을 수치로 변환하여 기록
    - `n`, `ㄴ` 등 부정 응답: PR 생성 취소
- **서술형 입력 처리 규칙**:
    - "내가 다했다", "내가다해먹음", "100%", "전부 내가" → `100:0`
    - "AI가 거의 다했다", "AI가 대부분", "10%", "거의 AI" → `10:90`
    - "반반", "50%", "비슷하게", "둘 다" → `50:50`
    - "내가 좀 더", "60%", "내가 주로" → `60:40`
    - "AI가 좀 더", "40%", "AI가 주로" → `40:60`
    - "내가 많이", "70%", "대부분 내가" → `70:30`
    - "AI가 많이", "30%", "대부분 AI" → `30:70`
- **사용자가 비율을 입력한 경우**: PR 본문 하단에 다음 형식으로 추가
    ```markdown
    ---

    ## 📝 사용자 체감 기여도

    **사용자**: 60% | **AI**: 40%

    > 위 비율은 PR 작성자가 주관적으로 평가한 전체 기여도입니다.
    ```

### 6단계: PR 생성 및 링크 제공

- 우선: GitHub CLI (`gh pr`) 명령어 사용 (rate limit에 덜 취약함)
- 차선책: GitHub MCP 사용 (GitHub CLI 실패 시에만 사용)
- 본인을 assignee로 설정
- 생성된 PR URL 제공
- draft 상태 여부 확인

## 출력 형식

```text
=== 생성될 Pull Request 내용 ===
제목: feat: AUTH-123 사용자 인증 시스템 개선
본문: [비즈니스 배경 + 변경사항 + 테스트 계획 + JIRA 링크 포함]

=== AI 기여도 요약 (미리보기) ===
평균 기여도: 사용자 35% | AI 65%
💡 상세 분석은 PR 머지 후 자동으로 코멘트로 추가됩니다.

=== 승인 여부 입력 ===
y/n 또는 "50:50", "반반" 등 기여도 비율 입력
>
```

## 모범 사례

- **브랜치명 규칙 준수**: @.claude/docs/common/branch-naming-rules.md 참조
- Push 전 확인: PR 생성 전에 브랜치가 성공적으로 push되는지 확인 (pre-push 훅 통과 필요)
- 자동 Assignee 설정: PR 생성 시 본인을 assignee로 자동 설정하여 책임 명확화
- 명확한 제목: 변경 사항을 한 문장으로 요약
- 구체적인 설명: 왜 이 변경이 필요한지, 무엇을 개선하는지 설명
- 테스트 계획: 어떻게 테스트했는지, 어떤 점을 확인해야 하는지 명시
- 관련 이슈: JIRA 링크를 통해 관련 작업 추적
- 체크리스트: 리뷰어가 확인해야 할 항목들 나열

## PR 제목 예시

- feat: PAY-456 결제 모듈에 카카오페이 연동 추가
- fix: SRCH-789 상품 검색 시 필터링 오류 수정
- refactor: USER-321 사용자 서비스 코드 구조 개선
- docs: DOC-654 API 문서에 새로운 엔드포인트 추가
